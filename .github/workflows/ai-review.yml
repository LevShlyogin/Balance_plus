name: AI Code Review (Grok)

permissions:
  contents: read
  pull-requests: write

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  review:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v3

      - name: AI Code Reviewer
        uses: anc95/ChatGPT-CodeReview@main
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          # –£–±–µ–¥–∏—Å—å, —á—Ç–æ —Å–µ–∫—Ä–µ—Ç –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ —Ç–∞–∫, –∫–∞–∫ —Ç—ã –µ–≥–æ —Å–æ–∑–¥–∞–ª
          OPENAI_API_KEY: ${{ secrets.OPENROUTER_API_KEY }}
        with:
          # –ë–∞–∑–æ–≤—ã–π URL –¥–ª—è OpenRouter
          openai_api_base: "https://openrouter.ai/api/v1"
          
          # –¢–≤–æ—è –≤—ã–±—Ä–∞–Ω–Ω–∞—è –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –º–æ–¥–µ–ª—å
          MODEL: "x-ai/grok-4.1-fast:free"
          
          # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (0 - —Å—Ç—Ä–æ–≥–æ –∏ —Ç–æ—á–Ω–æ, 1 - –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ). 
          # –î–ª—è –∫–æ–¥–∞ –ª—É—á—à–µ —Å—Ç–∞–≤–∏—Ç—å –ø–æ–Ω–∏–∂–µ.
          openai_temperature: 0.2
          
          # –°–ò–°–¢–ï–ú–ù–´–ô –ü–†–û–ú–¢ (–ù–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫ –∏ —Å—Ç—Ä–æ–≥–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏)
          PROMPT: |
            –¢—ã ‚Äî Senior Software Architect –∏ —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ø—Ä–æ–≤–µ—Å—Ç–∏ –∫–æ–¥-—Ä–µ–≤—å—é –∏–∑–º–µ–Ω–µ–Ω–∏–π (diff) –≤ Pull Request.
            
            –¢—ã —Ä–∞–±–æ—Ç–∞–µ—à—å —Å –º–æ–¥–µ–ª—å—é xAI Grok, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–π —Å–≤–æ–π –æ–≥—Ä–æ–º–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–≤—è–∑–µ–π –≤ –∫–æ–¥–µ.
            
            –¢–í–û–ò –ü–†–ò–û–†–ò–¢–ï–¢–´:
            1. üõ°Ô∏è **–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ (–ö—Ä–∏—Ç–∏—á–Ω–æ)**: –ò—â–∏ SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏, XSS, —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö, —Å–ª–∞–±—ã–µ –º–µ—Å—Ç–∞ –≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
            2. üèóÔ∏è **–ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ò SOLID**: –ö–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å—Ç—ã–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–º.
            3. üöÄ **–ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨**: –£–∫–∞–∑—ã–≤–∞–π –Ω–∞ O(n^2) –≤ —Ü–∏–∫–ª–∞—Ö, —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ –∏–ª–∏ –ª–∏—à–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î.
            4. üßπ **–ß–ò–°–¢–û–¢–ê –ö–û–î–ê**: –ù–µ–π–º–∏–Ω–≥ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–∏—à–Ω–µ–≥–æ –∫–æ–¥–∞ (dead code).
            
            –§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê (–°–¢–†–û–ì–û –ù–ê –†–£–°–°–ö–û–ú –Ø–ó–´–ö–ï):
            - –ò—Å–ø–æ–ª—å–∑—É–π Markdown –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.
            - –ï—Å–ª–∏ –∑–∞–º–µ—á–∞–Ω–∏–π –Ω–µ—Ç, –Ω–∞–ø–∏—à–∏: "‚úÖ **LGTM! –ö–æ–¥ –≤—ã–≥–ª—è–¥–∏—Ç –æ—Ç–ª–∏—á–Ω–æ.**" –∏ –¥–æ–±–∞–≤—å –∫–æ—Ä–æ—Ç–∫–∏–π –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π.
            - –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã, —Ä–∞–∑–±–µ–π –∏—Ö –ø–æ —É—Ä–æ–≤–Ω—è–º:
              - üî¥ **–ö–†–ò–¢–ò–ß–ù–û**: –ë–∞–≥–∏, —É—è–∑–≤–∏–º–æ—Å—Ç–∏, –ª–æ–º–∞—é—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.
              - üü° **–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï**: –ü–ª–æ—Ö–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è.
              - üîµ **–°–û–í–ï–¢**: –ö–∞–∫ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∫—Ä–∞—Å–∏–≤–µ–µ (–≤–∫—É—Å–æ–≤—â–∏–Ω–∞).
            - –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–≤–æ–¥–∏ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞: "–ö–∞–∫ —Å–µ–π—á–∞—Å" -> "–ö–∞–∫ –ª—É—á—à–µ".
            
            –ù–µ –æ–±—ä—è—Å–Ω—è–π, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥, –µ—Å–ª–∏ –≤ —ç—Ç–æ–º –Ω–µ—Ç –æ—à–∏–±–∫–∏. –ü–∏—à–∏ –∫—Ä–∞—Ç–∫–æ –∏ –ø–æ –¥–µ–ª—É.
            
          # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –Ω—É–∂–Ω–æ —á–∏—Ç–∞—Ç—å (–ª–æ–≥–∏, –ª–æ–∫-—Ñ–∞–π–ª—ã, –∫–∞—Ä—Ç–∏–Ω–∫–∏)
          ignore_patterns: "yarn.lock,package-lock.json,*.lock,*.png,*.jpg,*.svg,dist/*"
