# [DB-EQUIP-CONDENSER] База данных: Конденсаторы паровых турбин

**Версия схемы:** 1.0<br>
**Статус:** Черновик<br>
**Ответственный:** @D0k2<br>
**Участник:** -<br> 
**Связанные методики:**
1. [CALC-COND-METRO_VIKKERS] [Метод Метро-Виккерс](https://github.com/LevShlyogin/Balance_plus/blob/main/docs/methods/balance/CALC-COND-METRO_VIKKERS.md)
2. [CALC-COND-BERMAN] [Метод Бермана](https://github.com/LevShlyogin/Balance_plus/blob/main/docs/methods/balance/CALC-COND-BERMAN.md)

## 1. Описание сущности
БД хранит физические характеристики поверхностных конденсаторов. Данные используются для теплогидравлических расчетов и валидации режимов работы.
Источники данных: Теплогидравлический расчет конденсатора, Паспорт конденсатора, Сборочный чертеж.

## 2. Структура данных (Schema)

### 2.1. Основная геометрия (Geometry)
Параметры трубной системы. Если конденсатор имеет разделение на потоки, указываются параметры для одного корпуса/потока, если не указано иное.

| Ключ (Code) | Название (UI) | Ед. изм. | Тип | Обяз. | Описание / Источник | Валидация |
| :--- | :--- | :---: | :---: | :---: | :--- | :--- |
| `diameter_inside` | Внутренний диаметр труб ($d_{in}$) | мм | Float | **Да** | Внутренний диаметр трубок охлаждения | > 0 |
| `wall_thickness` | Толщина стенки ($s_{tube}$) | мм | Float | **Да** | Толщина стенки трубки | > 0 |
| `tube_material_id` | Материал трубок | ID | Ref | **Да** | Ссылка на справочник материалов (`DB-MATERIALS`) | Список |
| `tubes_main_length` | Активная длина труб ОП ($L_{OP}$) | мм | Float | **Да** | Длина теплообменной части основного пучка (между трубными досками) | > 0 |
| `tubes_main_count` | Число труб ОП ($N_{OP}$) | шт | Int | **Да** | Количество трубок в основном пучке | > 0 |
| `tubes_builtin_length`| Активная длина труб ВП ($L_{VP}$) | мм | Float | Нет | Длина труб встроенного пучка (если есть) | >= 0 |
| `tubes_builtin_count` | Число труб ВП ($N_{VP}$) | шт | Int | Нет | Количество трубок во встроенном пучке | >= 0 |
| `tubes_aircooler_count`| Число труб ВО ($N_{VO}$) | шт | Int | Нет | Количество трубок воздухоохладителя. *Если не задано, методика Метро-Виккерс считает как 15% от суммы ОП+ВП.* | >= 0 |
| `passes_main` | Число ходов воды ОП ($Z_{OP}$) | - | Int | **Да** | Конструктивное число ходов в основном пучке | >= 1 |
| `passes_builtin` | Число ходов воды ВП ($Z_{VP}$) | - | Int | Нет | Конструктивное число ходов во встроенном пучке | >= 1 |
| `ejectors_count` | Число эжекторов ($Z_{ej}$) | шт | Int | Нет | Кол-во работающих эжекторов (влияет на расчет по Берману). Default = 1. | >= 1 |

### 2.2. Паспортные ограничения (Limits & Ratings)
Используются для валидации введенного режима.

| Ключ (Code) | Название (UI) | Ед. изм. | Тип | Обяз. | Описание | Валидация |
| :--- | :--- | :---: | :---: | :---: | :--- | :--- |
| `steam_load_nom` | Номинальная паровая нагрузка | т/ч | Float | **Да** | Расход пара в конденсатор по паспорту | > 0 |
| `cooling_flow_nom` | Ном. расход охл. воды | т/ч | Float | **Да** | Расчетный расход циркуляционной воды | > 0 |
| `cooling_flow_max` | Макс. расход охл. воды | т/ч | Float | Нет | Гидравлическое ограничение (макс) | > Nom |
| `cooling_flow_min` | Мин. расход охл. воды | т/ч | Float | Нет | Минимальный расход (заиление/срыв сифона) | < Nom |
| `max_temp_inlet` | Макс. температура входа | °С | Float | Нет | Ограничение методики или материала | <= 100 |

| Параметр | Обозначение (Код) | Символ | Единица | Описание |
| :--- | :--- | :---: | :---: | :--- |
| Расход воздуха | `mass_flow_air` | $G_{air}$ | кг/ч | Присосы воздуха |
| Расход пара ном. | `mass_flow_steam_nom` | $G_{nom}$ | т/ч | Номинальная нагрузка |
| Максимальный расход охлаждающей воды |  |  |  |  |
| Номинальный расход охлаждающей воды |  |  |  |  |
| Минимальный расход охлаждающей воды |  |  |  |  |
| Максимальный расход охлаждающей воды через основные и встроенные пучки |  |  |  |  |
| Минимальный расход охлаждающей воды через основные и встроенные пучки |  |  |  |  |
| Максимальный расход охлаждающей воды через основные и встроенные пучки в один ход |  |  |  |  |
| Номинальный расход охлаждающей воды через основные и встроенные пучки в один ход |  |  |  |  |
| Минимальный расход охлаждающей воды через основные и встроенные пучки в один ход |  |  |  |  |
| Максимальный расход охлаждающей воды через основные и встроенные пучки в два хода |  |  |  |  |
| Минимальный расход охлаждающей воды через основные и встроенные пучки в два хода |  |  |  |  |
| Максимальный расход охлаждающей воды через основные пучки |  |  |  | встроенные пучки отключены |
| Минимальный расход охлаждающей воды через основные пучки |  |  |  | встроенные пучки отключены |
| Максимальный расход охлаждающей воды через встроенные пучки в один ход |  |  |  | основные пучки отключены |
| Минимальный расход охлаждающей воды через встроенные пучки в один ход |  |  |  | основные пучки отключены |
| Максимальный расход охлаждающей воды через встроенные пучки в два хода |  |  |  | основные пучки отключены |
| Минимальный расход охлаждающей воды через встроенные пучки в два хода |  |  |  | основные пучки отключены |
| Максимальный расход охлаждающей воды через встроенные пучки в четыре хода |  |  |  | основные пучки отключены |
| Минимальный расход охлаждающей воды через встроенные пучки в четыре хода |  |  |  | основные пучки отключены |

## 3. Пример JSON (Payload)

```json
{
  "equipment_id": "K-1000-60/1500",
  "geometry": {
    "diameter_inside": 24.0,
    "wall_thickness": 1.0,
    "tube_material_id": "CuNi10Fe1Mn", 
    "tubes_main_length": 9000.0,
    "tubes_main_count": 14500,
    "tubes_builtin_length": 9000.0,
    "tubes_builtin_count": 2100,
    "tubes_aircooler_count": 500,
    "passes_main": 2,
    "passes_builtin": 2,
    "ejectors_count": 1
  },
  "limits": {
    "steam_load_nom": 600.0,
    "cooling_flow_nom": 32000.0,
    "cooling_flow_max": 36000.0,
    "cooling_flow_min": 15000.0
  }
}
```

## 4. Связь параметров БД с Методиками

Таблица маппинга переменных БД на переменные в коде методик.

| Параметр БД | Методика Метро-Виккерс (код) | Методика Бермана (код) | Комментарий |
| :--- | :--- | :--- | :--- |
| `diameter_inside` | `diameter_inside_of_pipes` | `diameter_inside_of_pipes` | 1:1 совпадение |
| `wall_thickness` | `thickness_pipe_wall` | `thickness_pipe_wall` | 1:1 совпадение |
| `tubes_main_length` | `length_cooling_tubes...` | `length_cooling_tubes...main...` | |
| `tubes_main_count` | `number_cooling_tubes...main...` | `number_cooling_tubes...main...` | |
| `tubes_aircooler_count`| `number_air_cooler_total_pipes` | *Не используется явно* | Берман использует `mass_flow_air` (входной параметр), геометрию ВО не учитывает детально |
| `ejectors_count` | *Не используется* | `number_ejector` | |

## 5. Особые указания
1. **Материал трубок:** В расчетах требуется теплопроводность $\lambda$. Она должна подтягиваться из микросервиса материалов по `tube_material_id` для средней температуры стенки.
2. **Воздухоохладитель (ВО):**
    *   Для **Метро-Виккерса**: Если `tubes_aircooler_count` = 0 или null, расчет ведется как 15% от общего числа.
    *   Для **Бермана**: Данное поле игнорируется, учет воздуха идет через характеристику эжектора.
